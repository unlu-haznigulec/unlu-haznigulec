name: Validate PR Source Branch

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  validate-branch:
    runs-on: ubuntu-latest
    steps:
      - name: Validate source branch rules
        run: |
          echo "üîç HEAD: ${{ github.head_ref }}"
          echo "üéØ BASE: ${{ github.base_ref }}"

          BASE="${{ github.base_ref }}"
          HEAD="${{ github.head_ref }}"

          if [[ "$BASE" == release/* && "$HEAD" != "dev" ]]; then
            echo "::error::‚ùå Only 'dev' is allowed to open PRs to 'release/*'"
            exit 1
          fi

          if [[ "$BASE" == "main" && "$HEAD" != release/* && "$HEAD" != hotfix/* ]]; then
            echo "::error::‚ùå Only 'release/*' or 'hotfix/*' can open PRs to 'main'"
            exit 1
          fi

          echo "‚úÖ PR source is allowed."
